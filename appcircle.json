{
  "version": "1",
  "workflows": {
    "ios-workflow": {
      "name": "iOS Build",
      "environment": {
        "flutter": "stable",
        "xcode": "latest",
        "cocoapods": "default"
      },
      "scripts": [
        {
          "name": "Get Flutter packages",
          "script": "flutter pub get"
        },
        {
          "name": "Flutter build ipa",
          "script": "flutter build ipa --release --export-options-plist=ios/exportOptions.plist"
        }
      ],
      "artifacts": [
        "build/ios/ipa/*.ipa",
        "build/ios/archive/*.xcarchive"
      ],
      "distribution": {
        "app_store_connect": {
          "api_key": "$APP_STORE_CONNECT_PRIVATE_KEY",
          "key_id": "$APP_STORE_CONNECT_KEY_ID",
          "issuer_id": "$APP_STORE_CONNECT_ISSUER_ID",
          "submit_to_testflight": true
        }
      }
    }
  }
}
